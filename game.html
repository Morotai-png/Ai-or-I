<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI or I</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zalando+Sans+Expanded:ital,wght@0,200..900;1,200..900&display=swap');

        /* Tailwind CSS Configuration for custom colors */
        .tailwind-config {
            display: none; /* Hide this div */
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: { 
                    colors: {
                        'black': '#000000',
                        'white': '#FFFFFF',
                        'aqua': '#00F2F2',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background: linear-gradient(#000000,rgb(5, 157, 157));
            background-color: black;
            display: flex;
            height: 100vh;
            padding: 10px;
            box-sizing: border-box;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        .screen-container {
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            border-radius: 15px;
            max-width: 850px;
            width: 90vh;
            height: 90vh;
            padding: 32px;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 20px;
            position: relative;
        }
        .hidden-screen {
            display: none !important;
        }
        
        /* Specific Screen styles */
        #landing-page, #difficulty-selection-page, #game-page, #results-page {
            min-height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            gap: 24px;
            box-sizing:content-box;
            padding-top: 20px;
            padding-bottom: 20px;
            position: relative;
        }

        #landing-page h4 {
            font-family:'Courier New', Courier, monospace;
            font-size: 1.25rem;
            font-weight: 500;
            color:teal;
        }
        #landing-page h1 {
            font-family: 'Zalando Sans Expanded', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            color: aqua;
        }

        #landing-page p {
            font-size: 1.2rem;
            color:white;
            margin-bottom: 5px; 
        }
        #landing-page .acknowledgement-text {
            font-size: 0.9rem;
            font-style: italic;
            color: gray;
            line-height: 1.6;
            max-width: 80%;
            margin-bottom: 50px;
        }
        .start-button {
            background-color: #000000; 
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-family:'Courier New', Courier, monospace;
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .start-button:hover {
            background-color: teal;
            transform: translateY(-2px);
        }
        
        /* Difficutly Selection Page */
        #difficulty-selection-page h2 {
            font-family: 'Zalando Sans Expanded', sans-serif;
            font-size: 2rem;
            font-weight: 600;
            color: white; 
            margin-bottom: 30px;
        }

        .difficulty-selection-grid {
            display: grid;
            grid-template-columns: auto auto auto;
            gap: 15px;
            width: 100%;
            max-width: 700px;
        }
        .difficulty-select-button {
            font-family: 'Zalando Sans Expanded', sans-serif;
            background-color: black; 
            color: white;
            padding: 20px 15px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border: none;
            font-size: 1.05rem;
            text-align: center;
        }

        .difficulty-select-button:hover {
            background-color: teal; 
            transform: translateY(-2px);
        }

        /* Game page */
        .profile-box {
            background-color: black; 
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 16px;
            height: 70vh;
            width:50vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 1.1rem;
            color: #1A1A1A; 
            line-height: 1.6;
            transition: background-color 0.5s ease; 
        }

        .profile-image {
            background-color: white;
            border-radius: 12px;
            padding:24px;
            height: 65vh;
            width:45vh;
            
        }
        .c-button {
            background-color: aqua; 
            color: black;
            border-radius: 75%;
            width:12vh;
            height:12vh;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            border: none;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.75rem;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12vh;
            justify-content: center;
            width: 75%; 
        }

        .action-area {
            display: flex;
            flex-direction: column;
            gap: 16px;
            align-items: center;
            margin-top: 16px; 
            width: 100%; 
        }
       
        #clockdiv { 
            font-family: 'Zalando Sans Expanded', sans-serif;
            color: #fff;
            font-weight: 150;
            text-align: center;
            font-size: 40px;
        }
        
        #textdiv { 
            font-family: 'Zalando Sans Expanded', sans-serif;
            color: #fff;
            font-weight: 150;
            text-align: center;
            font-size: 40px;
        }
        .text-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            justify-content: center;
            width: 75%; 
        }

        .text{
            padding-top: 5px;
            font-size: 16px;
        }

        /* Results Page */
        #results-page h2 {
            font-family: 'Zalando Sans Expanded', sans-serif;
            font-size: 2rem;
            font-weight: 600;
            color: white; 
            margin-bottom: 30px;
        }

        .results-button-grid {
            display: grid;
            grid-template-columns: repeat(1fr, 2);
            gap: 15px;
            width: 100%;
            max-width: 700px;
        }
        .results-select-button {
            font-family: 'Zalando Sans Expanded', sans-serif;
            background-color: black; 
            color: white;
            padding: 20px 15px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border: none;
            font-size: 1.05rem;
            text-align: center;
        }
        #results-text {
            font-family: 'Zalando Sans Expanded', sans-serif;
            color: #fff;
            font-weight: 150;
            text-align: center;
            font-size: 40px;
        }

        .results-select-button:hover {
            background-color: teal; 
            transform: translateY(-2px);
        }

        /* Menu */
        .menu-button {
            font-family:'Courier New', Courier, monospace;
            position: absolute;
            top: 12vh;
            left: 1vh;
            background-color: #000000;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border: none;
            z-index: 50;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .menu-button:hover {
            background-color: teal; 
        }

        /* Modal Styles */
        .modal {
            display: none;
            position:fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .modal-content {
            background-color: black;
            margin: auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            max-width: 600px;
            width: 100%;
            position: relative;
            text-align: left;
            color: white; 
            line-height: 1.6;
        }
        .modal-content h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: white; 
        }
        .modal-content p {
            margin-bottom: 10px;
        }
        .close-button {
            color: white;
            position: absolute;
            top: 15px;
            right: 25px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .close-button:hover,
        .close-button:focus {
            color: #333;
            text-decoration: none;
            cursor: pointer;
        }
        .loading-spinner {
            border: 4px solid #F4F4F4; 
            border-top: 4px solid #000000;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .menu-list {
            list-style: none;
            padding: 0;
            margin-bottom: 20px;
        }
        .menu-list li {
            margin-bottom: 10px;
        }
        .menu-list a {
            color: white; 
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }
        .menu-list a:hover {
            color: #333333;
        }
        .menu-section-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 20px;
            margin-bottom: 10px;
            color: white; 
            border-bottom: 1px solid #F4F4F4; 
            padding-bottom: 5px;
        }

        /* Mobile Responsiveness */ 
        @media (max-width: 640px) {
            .screen-container {
                padding: 20px;
                gap: 12px;
                
            }
            #landing-page, #difficulty-selection-page #game-page, #results-page {
                min-height: 80vh; 
                padding-top: 15px;
                padding-bottom: 15px;
            }

            .profile-box {
                font-size: 0.95rem;
                padding: 16px;
            }

            .c-button {
                padding: 10px 15px;
                font-size: 0.85rem;
                min-width: unset;
                width: 100%;
            }
            .button-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 20px;
            }
            .modal-content h3 {
                font-size: 1.2rem;
            }
            .menu-button {
                top: 10px;
                left: 10px;
                padding: 8px 12px;
                font-size: 0.8rem;
            }
    
            #landing-page h4 { font-size: 1rem; }
            #landing-page h1 { font-size: 2.2rem; }
            #landing-page p { font-size: 0.9rem; }
            #landing-page .acknowledgement-text { font-size: 0.7rem; }
            
            #difficulty-selection-page h2 { font-size: 1.3rem; }
            .difficulty-selection-grid {
                grid-template-columns: 1fr;
            }
            .difficulty-select-button {
                padding: 12px 10px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>

<body>
    <div class="screen-container">
        <div id="landing-page">
            <button id="menu-button-landing" class="menu-button">Menu</button>
            <div id="top-of-page" class="flex flex-col items-center">
                <h4 class="text x1 font-medium text-gray-700">ANU Inclusive and Respectful Communities</h4>
                <h1 class="font-mono">AI or I</h1>
            </div>
            <p>Interactive Media Literacy tool.</p>
            <p class="acknowledgement-text">"The Australian National University acknowledges, celebrates and pays our respects to the Ngunnawal and Ngambri people of the Canberra region and to all First Nations Australians on whose traditional lands we meet and work, and whose cultures are among the oldest continuing cultures in human history."</p>
            <button id="start-game-button" class="start-button" type="button" onclick="showScreen('difficulty-selection-page')">Start</button>
        </div>
        
        <div id="difficulty-selection-page" class="hidden-screen">
            <button id="menu-button-selection" class="menu-button">Menu</button>
            <h2>Choose difficulty:</h2>
            <div class="difficulty-selection-grid">
                <button class="difficulty-select-button" data-difficulty="easy"> Easy (2 min) </button>
                <button class="difficulty-select-button" data-difficulty="medium">Medium (1 min) </button>
                <button class="difficulty-select-button" data-difficulty="hard">Hard (30 sec) </button>
            </div>
        </div>
        
        <div id="game-page" class="hidden-screen">
            <button id="menu-button-game" class="menu-button">Menu</button>
            <div id="profile-display" class="profile-box">
                <div class="text-grid" id="info"> 
                    <div id="clockdiv">
                        <div>
                            <span class="minutes"></span>
                            <div class="text"></div>
                    </div>
                        <div>
                            <span class="seconds"></span>
                            <div class="text"></div>
                        </div>
                    </div>
                    <div id="textdiv">
                        <div>
                            <span class="score"></span>
                            <div class="text"></div>
                        </div>
                    </div>
                </div>
                <h3 id="profile-name"></h3>
                <img id="profile-image" src="Images/AI_1.jpg" data-action="AI">
                <div class="action-area">
                    <div class="button-grid" id="action-buttons">
                        <button class="c-button" data-action="AI"><i class="fa fa-close"></i></button>
                        <button class="c-button" data-action="R"><i class="fa fa-heart"></i></button>
                    </div>
                </div>    
            </div>
        </div>

        <div id="results-page" class="hidden-screen">
            <button id="menu-button-results" class="menu-button">Menu</button>
            <h2>Results:</h2>
            <div id="results-text">
                    <div class="text"></div>
            </div>
            <div class="results-button-grid" >
                <button class="results-select-button" data-action="return"> Return to Homepage </button>
                <button class="results-select-button" data-action="stats"> Show Answers </button>
            </div>
        </div>

        <div id="menuModal" class="modal">
        <div class="modal-content">
            <span class="close-button" data-modal-target="menuModal">&times;</span>
            <h1 class="font-mono">Game Menu</h1>

            <h4 class="menu-section-title">Navigation</h4>
            <ul data-section="navigation" class="menu-list">
                </ul>

            <h4 class="menu-section-title">Choose difficulty</h4>
            <ul id="difficulty-list" class="menu-list">
                </ul>

            <h4 class="menu-section-title">Support & Reporting</h4>
            <ul class="menu-list">
                <li><a href="https://www.anu.edu.au/students/health-safety-wellbeing/student-support" target="_blank" rel="noopener noreferrer">ANU Student Support Services</a></li>
                <li><a href="https://www.anu.edu.au/students/health-safety-wellbeing/counselling" target="_blank" rel="noopener noreferrer">ANU Counselling Centre</a></li>
                <li><a href="https://www.anu.edu.au/about/governance/committees/equity-and-diversity-committee" target="_blank" rel="noopener noreferrer">ANU Equity & Diversity Office</a></li>
                <li><a href="https://anu-advocate.symplicity.com/sash_report/index.php/pid715548?" target="_blank" rel="noopener noreferrer">Harmful Disclosure Tool</a></li>
                <li><a href="https://www.lifeline.org.au/" target="_blank" rel="noopener noreferrer">Lifeline (Australia) - 13 11 14</a></li>
            </ul>
        </div>
    </div>
    
    <audio id="hoverSound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-bling-2000.mp3" preload="auto"></audio>
    <audio id="clickSound" src="https://assets.mixkit.co/sfx/preview/mixkit-software-interface-click-1869.mp3" preload="auto"></audio>

    <script>

        let currentProfileNumber = 0;
        let difficultyId = null;
        let countdownTimer = 0;
        let score = 0; 
        let total = 0;
        let length = 5;
        let timer = document.getElementById('clockdiv').innerText;
        
        // DOM Elements
        const landingPage = document.getElementById('landing-page');
        const difficultySelectionPage = document.getElementById('difficulty-selection-page');
        const gamePage = document.getElementById('game-page');
        const resultsPage = document.getElementById('results-page');
        const startGameButton = document.getElementById('start-game-button');
        const difficultySelectButtons = document.querySelectorAll('.difficulty-select-button');
        const resultsButtons = document.querySelectorAll('.results-select-button');
    
        const profileBox = document.getElementById('profile-box');
        const profileImg = document.getElementById('profile-image');

        // Menu elements
        const menuButtonLanding = document.getElementById('menu-button-landing');
        const menuButtonSelection = document.getElementById('menu-button-selection');
        const menuButtonGame = document.getElementById('menu-button-game');
        const menuButtonResults = document.getElementById('menu-button-results');
        const menuModal = document.getElementById('menuModal');
        const menuModalCloseButton = menuModal.querySelector('.close-button');
        const difficultyList = document.getElementById('difficulty-list');
        const menuNavList = menuModal.querySelector('.menu-list[data-section="navigation"]'); 

        const buttons = document.querySelectorAll('.c-button', '.start-button');
        let gameActive = false;
        let currentGameId = null;
        let currentTimer;

        const difficulties = {'easy':{time: "120"}, 'medium':{time:"60"}, 'hard':{time: "30"}}

        function profile(answer, image, source, value) {
            this.answer = answer;
            this.image = image;
            this.source = source; 
            this.value = value;
        }
        const AI_1 = new profile("AI", "Images/AI_1.jpg", "thispersondoesn'texist.com", Math.random());
        const AI_2 = new profile("AI", "Images/AI_2.jpg", "https://x.com/immasiddx/status/1992979078220263720", Math.random());
        const AI_3 = new profile("AI", "Images/AI_3.jpg", "https://x.com/abhijitwt/status/1993946199716712677", Math.random());
        const R_1 = new profile("R", "Images/R_1.png", "https://unsplash.com/photos/a-couple-of-men-sitting-at-a-table-with-food-eGH2b7f_kws", Math.random());
        const R_2 = new profile("R", "Images/R_2.jpg", "https://unsplash.com/photos/woman-in-blue-jacket-standing-beside-walls-ANNsvl-6AG0", Math.random());
        
        
        const profileArray = [AI_1, AI_2, AI_3, R_1, R_2];
        const gameArray = [AI_1, AI_2, AI_3, R_1, R_2];
        const profilelength = profileArray.length;
        function randomNumber(num) { 
            let randomNum = Math.random();
            randomNum = Math.floor(randomNum*10);
            let idx = randomNum % num;
            return idx;
        }

        // Randomise the profiles shown for unique games
        function randomiseArray(array) {
            if (array.length == 0) {
               refillArray(array); 
            }

            array = array.sort(function(a, b) {return a.value - b.value})
            return array;
        }
        
        function refillArray(array) {
            for (var i = 0; i < profileArray.length; i++) { 
                array.push(profileArray[i]);
            }
        }

        // Function to show a specific screen and hide others
        function showScreen(screenId) {
            const screens = [landingPage, difficultySelectionPage, gamePage, resultsPage];
            screens.forEach(screen => {
                screen.classList.add('hidden-screen');
            });

            const targetScreen = document.getElementById(screenId);
            if (targetScreen) { 
                targetScreen.classList.remove('hidden-screen');
            }
        }

        function tick(time) {
            if (time <= 0) {
                return 0;
            }

            countdownTimer = setTimeout(() => {
                const newTime = time - 1;
                document.getElementById('clockdiv').innerText = formatTime(newTime); 
                tick(newTime);
            }, 1000);
        }

        // display time on screen for game
        function formatTime(time) {
            minutes = Math.floor(time / 60);
            seconds = time - minutes * 60;
  
            if (String(seconds).length == 1) {
                return String(minutes) + ":0" + String(seconds);
            } else if (String(seconds).length == 1) {
                return "0:0";
            }
            return String(minutes) + ":" + String(seconds);
        }

        // Change profile after answer selected
        function updateProfile(array) {
            total++;
            if (total == profilelength+1) {
                return null;
            }
            currentProfile = array.pop();
            document.getElementById('profile-image').src = currentProfile.image;
            document.getElementById('profile-image').action = currentProfile.answer;
            return array;
        }

        // Game loop
        function startGame(totalSeconds, array) {
            formatTime(totalSeconds);
            tick(totalSeconds);
            buttons.forEach(button => {
                button.addEventListener('click',  (event) => { 
                    const action = event.target.closest('.c-button')?.dataset.action;
                    if (action) { 
                        if (action == currentProfile.answer) { 
                            score++;
                            document.getElementById('textdiv').innerText = score;
                            array = updateProfile(array);
                        } else if (action != currentProfile.answer) { 
                            document.getElementById('textdiv').innerText = score;
                            array = updateProfile(array);
                        } 
                    }
                    if (total == profilelength+1) {
                        showResults();
                    }
                });
            });
            if (countdownTimer == 0 || gameArray.length == 0) {
            showResults();
            }  
        }

        // Results screen 
        function showResults() { 
            showScreen('results-page');
            document.getElementById('results-text').innerText = String(score) + " / " + String(total-1);
            console.log(score);
            resultsButtons.forEach(button => {
                button.addEventListener('click',  (event) => { 
                    event.preventDefault();
                    const action = event.target.dataset.action;
                    
                    if (action == "return") { 
                        resetGame();
                    } else if (action == "stats") {
                        showScreen('difficulty-selection-page');
                    }
                });
            });
        }

        // Function to reset the game (full restart from landing page)
        function resetGame() {
            currentGameId = null;
            gameActive = false;
            countdownTimer = 0; 
            currentProfile = 0; // Reset part number
            score = 0;
            total = 0;
            difficultyId = null;
            refillArray(gameArray);
            populateMenuNavigation();
            populateDifficultyList();
            showScreen('landing-page');
        }

        // Load game data
        function loadGame(difficultyId) { 
            if (difficultyId == "easy") { 
                difficulty = difficulties;
                countdownTimer = 120;
            } else if (difficultyId == "medium") { 
                difficulty = difficulties;
                countdownTimer = 60;
            } else if (difficultyId == "hard") { 
                difficulty = difficulties;
                countdownTimer = 30;
            }
            if (!difficulty) {
                console.error("Difficulty not found:", difficultyId);
                return;
            }
            clearTimeout(countdownTimer); 
            score = 0;
            document.getElementById('textdiv').innerText = 0;
            document.getElementById('clockdiv').innerText = formatTime(countdownTimer);
            randomiseArray(gameArray);
            updateProfile(gameArray);
            startGame(countdownTimer, gameArray);
            showScreen('game-page');
        }

        // Menu Modal Logic
        menuButtonLanding.addEventListener('click', () => {
            menuModal.style.display = 'flex';
            populateMenuNavigation();
            populateDifficultyList(); 
        });
        menuButtonSelection.addEventListener('click', () => {
            menuModal.style.display = 'flex';
            populateMenuNavigation(); 
            populateDifficultyList(); 
        });
        
        menuButtonGame.addEventListener('click', () => {
            menuModal.style.display = 'flex';
            populateMenuNavigation(); 
            populateDifficultyList(); 
        });

        menuButtonResults.addEventListener('click', () => {
            menuModal.style.display = 'flex';
            populateMenuNavigation(); 
            populateDifficultyList(); 
        });

        menuModalCloseButton.addEventListener('click', (e) => {
            menuModal.style.display = 'none';
        });

        function populateMenuNavigation() {
            menuNavList.innerHTML = ''; // Clear existing navigation list

            const homeItem = document.createElement('li');
            const homeLink = document.createElement('a');
            homeLink.href = '#top-of-page'; // Anchor link to the top of the landing page
            homeLink.textContent = 'Home (Landing Page)';
            homeLink.addEventListener('click', (e) => {
                e.preventDefault();
                resetGame();
                menuModal.style.display = 'none';
                showScreen('landing-page');
                // Use smooth scroll to top of the page after showing it
                document.getElementById('top-of-page').scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
            homeItem.appendChild(homeLink);
            menuNavList.appendChild(homeItem);

            const newGameItem = document.createElement('li');
            const newGameLink = document.createElement('a');
            newGameLink.href = '#';
            newGameLink.textContent = 'Start New Game (Difficulty Selection)';
            newGameLink.addEventListener('click', (e) => {
                e.preventDefault();
                menuModal.style.display = 'none';
                showScreen('difficulty-selection-page');
            });
            newGameItem.appendChild(newGameLink);
            menuNavList.appendChild(newGameItem);

            menuModalCloseButton.addEventListener('click', () => {
            menuModal.style.display = 'none';
            });
        }

        function populateDifficultyList() {
            difficultyList.innerHTML = '';
            const difficultyOptions = [
                { id: '1', text: 'Easy: 30 profiles in 2 minutes'},
                { id: '2', text: 'Medium: 30 profiles in 1 minute'},
                { id: '3', text: 'Hard: 30 profiles in 30 seconds'}
            ];

            difficultyOptions.forEach(option => {
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = '#';
                link.textContent = option.text;
                link.dataset.difficultyId = option.id;
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    menuModal.style.display = 'none';
                    numProfiles = 0; // Reset part number for a new scenario start
                    loadGame(option.id);
                });
                listItem.appendChild(link);
                difficultyList.appendChild(listItem);
            });
        }

        // Event listener for Start Game button
        startGameButton.addEventListener('click', () => { 
            populateDifficultyList(); 
            showScreen('difficulty-selection-page');              
        });

        // Event listeners for difficulty selection buttons
        difficultySelectButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                event.preventDefault();
                const difficultyId = event.target.dataset.difficulty;
                currentProfileNumber = 0; // Reset part number for a new scenario start
                loadGame(difficultyId);
            });
        });

        // Initial game load: show landing page
        window.onload = () => {
            showScreen('landing-page');
            
            // Ensure navigation links are populated on load for the menu
            populateMenuNavigation();
            populateDifficultyList();
        };
    </script>
</body>
</html>
